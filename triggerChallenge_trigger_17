trigger triggerChallenge_trigger_17 on Opportunity (before insert,before update) {
    
     if(trigger.isBefore && (trigger.isInsert || trigger.isUpdate))
    {
        Set<Id> oppIds = new Set<Id>();
        for(Opportunity opp: Trigger.new)
        {
            oppIds.add(opp.AccountId);
        }
        Map<Id,Account> accMap= new Map<Id,Account>([Select Id,AnnualRevenue From Account Where Id IN: oppIds]);
        
        for(Opportunity opp: Trigger.new)
        {
            Account acc = accMap.get(opp.AccountId);
            Decimal rev = acc.AnnualRevenue;
            
            if(rev != null && opp.Amount < rev)
            {
                opp.addError('ensure that the Opportunity Amount is never lower than the Account AnnualRevenue ');
            }
        }
    }

}
